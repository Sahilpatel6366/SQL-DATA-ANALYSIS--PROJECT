-- chane over time analysis---
Purpose:
    - To track trends, growth, and changes in key metrics over time.
    - For time-series analysis and identifying seasonality.
    - To measure growth or decline over specific periods.

select 
    extract(year from order_date) as order_year,
	  sum(sales_amount) as total_Sales,
	  count(distinct customer_key) as total_customers,
	  sum(quantity) as total_quantity
from fact_Sales
where order_date is not null
group by extract(year from order_date)
order by total_Sales desc

Cumulative Analysis
===============================================================================
Purpose:
    - To calculate running totals and moving average for key metrics.
    - To track performance over time cumulatively.
    - Useful for growth analysis or identifying long-term trends.

select order_date,
       total_sales,
      sum(total_sales) over(order by order_date) as running_total_sales,
	  avg(moving_average) over (order by order_Date) as moving_average
from
(
select 
     date_trunc('year', order_date) as order_date,
     sum(sales_amount) as total_sales,
	avg(price) as moving_average
from fact_sales
where order_date is not null
group by date_trunc('year',order_date)
)t
